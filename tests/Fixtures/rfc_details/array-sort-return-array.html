<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: rfc:array-sort-return-array</title>

  <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="rfc,array-sort-return-array"/>
<link rel="search" type="application/opensearchdescription+xml" href="/lib/exe/opensearch.php" title="PHP Wiki"/>
<link rel="start" href="/"/>
<link rel="contents" href="/rfc/array-sort-return-array?do=index" title="Sitemap"/>
<link rel="manifest" href="/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="/feed.php?mode=list&amp;ns=rfc"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="/_export/xhtml/rfc/array-sort-return-array"/>
<link rel="alternate" type="text/plain" title="Wiki Markup" href="/_export/raw/rfc/array-sort-return-array"/>
<link rel="canonical" href="https://wiki.php.net/rfc/array-sort-return-array"/>
<link rel="stylesheet" href="/lib/exe/css.php?t=phpnet&amp;tseed=7bd2b78bb5550d8ceb3c825c96dd22d0"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='rfc';var JSINFO = {"id":"rfc:array-sort-return-array","namespace":"rfc","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script src="/lib/exe/jquery.php?tseed=f0349b609f9b91a485af8fd8ecd4aea4" defer="defer">/*<![CDATA[*/
/*!]]>*/</script>
<script src="/lib/exe/js.php?t=phpnet&amp;tseed=7bd2b78bb5550d8ceb3c825c96dd22d0" defer="defer">/*<![CDATA[*/
/*!]]>*/</script>
<!--<![endif]-->
  <link media='all' rel='stylesheet' href='//shared.php.net/styles/defaults.css?filemtime=1732659606'/>
  <link media='all' rel='stylesheet' href='//shared.php.net/styles/wiki.css?filemtime=1707322306'/>

  <link href="//fonts.googleapis.com/css?family=Fira+Sans|Source+Sans+Pro:300,400,600,400italic,600italic|Source+Code+Pro&amp;subset=latin,latin-ext" rel="stylesheet">
  <link rel="shortcut icon" href="//php.net/favicon.ico">
<!--[if lt IE 9]>
  <script src="//shared.php.net/js/html5shiv.js"></script>
<![endif]-->
  </head>
<body id="">

<div class="wrap">
<header class='clearfix'>
  <div id="mainmenu-toggle-overlay"></div>
  <input type="checkbox" id="mainmenu-toggle">
  <nav class="fullscreen">
    <div class="mainscreen">
      <a href="/" class="home"><img src="//php.net/images/logo.php?" width="48" height="24" alt="php"><span class="subdomain"></span></a>
      <ul>
        <li class=""><a href="?do=login">Login</a></li>
        <li class=""><a href="?do=register">Register</a></li>
      </ul>
    </div>
    <div class="secondscreen">
      <form method="get" action="/start">
        <input type="search" placeholder="Search" name="id" class="search">
        <input type="hidden" name="do" value="search">
      </form>
    </div>
  </nav>
</header>
<div id="flash-message"></div>
<nav id="megadropdown"></nav>

<section class="fullscreen clearfix">


<section id="breadcrumbs">
<nav>
<span class="bchead">You are here: </span><span class="home"><bdi><a href="/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> › <bdi><a href="/rfc" class="wikilink1" title="rfc" data-wiki-id="rfc">rfc</a></bdi> › <bdi><a href="/rfc/array-sort-return-array" class="wikilink1" title="rfc:array-sort-return-array" data-wiki-id="rfc:array-sort-return-array">array-sort-return-array</a></bdi></nav>
</section>
<section class="mainscreen">
    <!--[if lte IE 7 ]><div id="IE7"><![endif]--><!--[if IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_phpnet     ">


        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">

                <div class="pageId"><span>rfc:array-sort-return-array</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                                        
<h1 class="sectionedit1" id="php_rfcchange_behaviour_of_array_sort_functions_to_return_a_copy_of_the_sorted_array">PHP RFC: Change behaviour of array sort functions to return a copy of the sorted array</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> Version: 0.1</div>
</li>
<li class="level1"><div class="li"> Date: 2024-10-20</div>
</li>
<li class="level1"><div class="li"> Author: Gina Peter Banyard <a href="mailto:&#103;&#105;&#114;&#103;&#105;&#97;&#115;&#64;&#112;&#104;&#112;&#46;&#110;&#101;&#116;" class="mail" title="&#103;&#105;&#114;&#103;&#105;&#97;&#115;&#64;&#112;&#104;&#112;&#46;&#110;&#101;&#116;">&#103;&#105;&#114;&#103;&#105;&#97;&#115;&#64;&#112;&#104;&#112;&#46;&#110;&#101;&#116;</a></div>
</li>
<li class="level1"><div class="li"> Status: Withdrawn</div>
</li>
<li class="level1"><div class="li"> Target Version: PHP 8.5</div>
</li>
<li class="level1"><div class="li"> Implementation: TBD</div>
</li>
<li class="level1"><div class="li"> First Published at: <a href="https://wiki.php.net/rfc/array-sort-return-array" class="urlextern" title="https://wiki.php.net/rfc/array-sort-return-array" rel="ugc nofollow">https://wiki.php.net/rfc/array-sort-return-array</a></div>
</li>
</ul>

</div>

<h2 class="sectionedit2" id="introduction">Introduction</h2>
<div class="level2">

<p>
The PHP array sort functions take the array to sort as a by-reference array to sort the array in place.
However, since PHP 5.6 these function have only ever returned <code class="code php"><span class="kw4">true</span></code>.
</p>

<p>
Moreover, it would only return <code class="code php"><span class="kw4">false</span></code> (or <code class="code php"><span class="kw4">null</span></code>) prior to this version in case of a memory allocation failure.
This effectively means the return values of these functions are useless.
Similarly, <code class="code php"><a href="http://www.php.net/array_walk"><span class="kw3">array_walk</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code>, <code class="code php"><a href="http://www.php.net/array_walk_recursive"><span class="kw3">array_walk_recursive</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code>, and <code class="code php"><a href="http://www.php.net/shuffle"><span class="kw3">shuffle</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code> have only ever returned <code class="code php"><span class="kw4">true</span></code>
(or in case of type errors <code class="code php"><span class="kw4">null</span></code> or <code class="code php"><span class="kw4">false</span></code> which are proper <code class="code php">TypeError</code>s as of PHP 8.0) since at least PHP 5.3.
One last array function that now only returns <code class="code php"><span class="kw4">true</span></code> since PHP 8.0 is <code class="code php"><a href="http://www.php.net/array_multisort"><span class="kw3">array_multisort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code>,
when all warnings and false returns were converted to <code class="code php">ValueError</code>s and <code class="code php">TypeError</code>s.
</p>

<p>
This behaviour is annoying as it makes writing code in a functional way more cumbersome and tedious.
Indeed, when working with higher order functions (e.g. <code class="code php"><a href="http://www.php.net/array_map"><span class="kw3">array_map</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code>),
one cannot just use these functions as callbacks
and must instead wrap them in a closure which returns the sorted array.
</p>

</div>

<h2 class="sectionedit3" id="proposal">Proposal</h2>
<div class="level2">

<p>
Change the return value of:
</p>
<ul>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/sort"><span class="kw3">sort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/rsort"><span class="kw3">rsort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/asort"><span class="kw3">asort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/arsort"><span class="kw3">arsort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/ksort"><span class="kw3">ksort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/krsort"><span class="kw3">krsort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/natsort"><span class="kw3">natsort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/natcasesort"><span class="kw3">natcasesort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/usort"><span class="kw3">usort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/uasort"><span class="kw3">uasort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/uksort"><span class="kw3">uksort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/array_multisort"><span class="kw3">array_multisort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/shuffle"><span class="kw3">shuffle</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/array_walk"><span class="kw3">array_walk</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
<li class="level1"><div class="li"> <code class="code php"><a href="http://www.php.net/array_walk_recursive"><span class="kw3">array_walk_recursive</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code></div>
</li>
</ul>

<p>
from <code class="code php"><span class="kw4">true</span></code> to a copy of the <code class="code php"><a href="http://www.php.net/array"><span class="kw3">array</span></a></code> that is sorted, traversed, or shuffled.
</p>

<p>
This operation is effectively “for free” as we just increment the reference count of the sorted array by one.
</p>

</div>

<h2 class="sectionedit4" id="backward_incompatible_changes">Backward Incompatible Changes</h2>
<div class="level2">

<p>
Sorting an empty array and checking the return value of one of the <code class="code php"><a href="http://www.php.net/sort"><span class="kw3">sort</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></code> functions
would now be falsy rather than <code class="code php"><span class="kw4">true</span></code>.
</p>

</div>

<h2 class="sectionedit5" id="unaffected_php_functionality">Unaffected PHP Functionality</h2>
<div class="level2">

<p>
The functions continue to take the first parameter by-reference and do the sorting in-place.
</p>

<p>
The sort methods from the SPL <code class="code php">ArrayObject</code> class are not affected by this change.
</p>

</div>

<h2 class="sectionedit6" id="version">Version</h2>
<div class="level2">

<p>
Next minor version, PHP 8.5.
</p>

</div>

<h2 class="sectionedit7" id="vote">Vote</h2>
<div class="level2">

<p>
As per the voting <abbr title="Request for Comments">RFC</abbr> a yes/no vote with a 2/3 majority is needed for this proposal to be accepted.
</p>

<p>
Voting started on 2024-XX-XX and will end on 2024-XX-XX.
</p>

<!-- Doodle Plugin -->
<form action="/start" method="post" name="doodle__form" id="doodle__form__accept_change_behaviour_of_array_sort_functions_to_return_a_copy_of_the_sorted_array_rfc" accept-charset="utf-8" >

<input type="hidden" name="sectok" value="" />
<input type="hidden" name="do" value="show" >
<input type="hidden" name="id" value="rfc:array-sort-return-array" >
<input type="hidden" name="formId" value="doodle__form__accept_change_behaviour_of_array_sort_functions_to_return_a_copy_of_the_sorted_array_rfc" >
<input type="hidden" name="edit__entry"   value="">
<input type="hidden" name="delete__entry" value="">

<table class="inline">
  <tbody>
    <tr class="row0">
      <th class="centeralign" colspan="3">
        Accept Change behaviour of array sort functions to return a copy of the sorted array RFC?      </th>
    </tr>
    <tr class="row1">
        <th class="col0">Real name</th>
        <td class="centeralign">Yes</td>
        <td class="centeralign">No</td>
    </tr>

 
    <!-- Results / sum per column -->
    <tr>
        <th class="rightalign"><b>Final result:</b></th>
        <th class="centeralign"><b>0</b></th>
        <th class="centeralign"><b>0</b></th>
    </tr>


    
    <tr>
      <td colspan="3">
        This poll has been closed.      </td>
    </tr>

  </tbody>
</table>

</form>





</div>

<h2 class="sectionedit8" id="references">References</h2>
<div class="level2">

<p>
Internals discussion thread: <a href="https://externals.io/message/125809" class="urlextern" title="https://externals.io/message/125809" rel="ugc nofollow">https://externals.io/message/125809</a>
</p>

</div>
                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>rfc/array-sort-return-array.txt</bdi> · Last modified: 2025/04/03 13:08 by <bdi>127.0.0.1</bdi></div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <!-- PAGE ACTIONS -->
            <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="/rfc/array-sort-return-array?do=edit"  class="action source" accesskey="v" rel="nofollow" title="Show pagesource [V]"><span>Show pagesource</span></a></li><li><a href="/rfc/array-sort-return-array?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]"><span>Old revisions</span></a></li><li><a href="/rfc/array-sort-return-array?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div><!-- /wrapper -->

    </div></div><!-- /site -->

    <div class="no"><img src="/lib/exe/taskrunner.php?id=rfc%3Aarray-sort-return-array&amp;1749905232" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if ( lte IE 7 | IE 8 ) ]></div><![endif]-->
</section>

﻿<section class="secondscreen">
  <!-- TOC START -->
<div id="dw__toc" class="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#php_rfcchange_behaviour_of_array_sort_functions_to_return_a_copy_of_the_sorted_array">PHP RFC: Change behaviour of array sort functions to return a copy of the sorted array</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#introduction">Introduction</a></div></li>
<li class="level2"><div class="li"><a href="#proposal">Proposal</a></div></li>
<li class="level2"><div class="li"><a href="#backward_incompatible_changes">Backward Incompatible Changes</a></div></li>
<li class="level2"><div class="li"><a href="#unaffected_php_functionality">Unaffected PHP Functionality</a></div></li>
<li class="level2"><div class="li"><a href="#version">Version</a></div></li>
<li class="level2"><div class="li"><a href="#vote">Vote</a></div></li>
<li class="level2"><div class="li"><a href="#references">References</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->
</section>
</section><!-- .fullscreen -->
<footer>
  <nav class="fullscreen">
    <ul>
      <li><a href="//php.net/copyright">Copyright © 2001-2025 The PHP Group</a></li>
      <li><a href="//php.net/sites">Other PHP.net sites</a></li>
      <li><a href="//php.net/privacy">Privacy policy</a></li>
    </ul>
  </nav>
</footer>

</div><!-- .wrap -->
</body>
</html>
